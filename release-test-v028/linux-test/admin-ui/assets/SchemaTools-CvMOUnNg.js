import{o as ge,r,j as e,ap as ye,y as G,aK as J,q as be,g as pe,E as ue,aH as je,D as Ne}from"./index-rtSsgAPH.js";import{G as M}from"./git-branch-3a0AzAer.js";import{H as D}from"./history-CViVRNMq.js";import{R as T}from"./refresh-cw-BVqTSYJG.js";import{C as U}from"./copy-D82H1pRr.js";import{D as q}from"./download-BFz00aPs.js";import{T as fe}from"./table-2-roQtI1wP.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=ge("ArrowRightLeft",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]),ke="/api",x=`${ke}/admin/dbmanager/v1`;function Oe(){const[R,H]=r.useState("diagram"),[o,n]=r.useState(!1),[E,t]=r.useState(null),[v,I]=r.useState([]),[b,K]=r.useState("mermaid"),[p,$]=r.useState(""),[g,Q]=r.useState("public"),[y,X]=r.useState(""),[c,W]=r.useState(null),[u,Y]=r.useState(""),[l,Z]=r.useState(null),[j,ee]=r.useState("table"),[h,A]=r.useState(""),[m,N]=r.useState({include_indexes:!0,include_constraints:!0,include_triggers:!1,if_not_exists:!0}),[f,ae]=r.useState(""),[k,se]=r.useState([]),[w,L]=r.useState(""),[V,F]=r.useState(""),[d,_]=r.useState(null),[te,re]=r.useState([]),[B,le]=r.useState(["public"]);r.useEffect(()=>{ne(),de()},[]);const ne=async()=>{try{const a=await fetch(`${x}/tables`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")||""}`}});if(a.ok){const s=await a.json();s.success&&s.data&&re(s.data.map(i=>i.name))}}catch(a){console.error("Failed to fetch tables:",a)}},de=async()=>{le(["public","information_schema","pg_catalog"])},ce=async()=>{n(!0),t(null);try{const s=await(await fetch(`${x}/schema/relationships`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")||""}`}})).json();s.success?(I(s.data.relationships||[]),$(s.data.diagram||"")):t(s.error||"Failed to fetch relationships")}catch{t("Failed to fetch relationships")}finally{n(!1)}},ie=async()=>{n(!0),t(null);try{const s=await(await fetch(`${x}/schema/er-diagram?format=${b}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")||""}`}})).json();s.success?($(s.data.diagram||""),I(s.data.tables||[])):t(s.error||"Failed to generate diagram")}catch{t("Failed to generate ER diagram")}finally{n(!1)}},oe=async()=>{if(!g||!y){t("Please select two schemas to compare");return}n(!0),t(null);try{const s=await(await fetch(`${x}/schema/compare`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:JSON.stringify({schema1:g,schema2:y})})).json();s.success?W(s.data):t(s.error||"Failed to compare schemas")}catch{t("Failed to compare schemas")}finally{n(!1)}},z=async()=>{if(u.trim()){n(!0),t(null);try{const s=await(await fetch(`${x}/schema/search`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:JSON.stringify({query:u,search_tables:!0,search_columns:!0,search_indexes:!0,search_constraints:!0,search_functions:!0,search_triggers:!0})})).json();s.success?Z(s.data):t(s.error||"Search failed")}catch{t("Search failed")}finally{n(!1)}}},me=async()=>{if(!h){t("Please select an object");return}n(!0),t(null);try{const s=await(await fetch(`${x}/schema/ddl`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:JSON.stringify({object_type:j,object_name:h,...m})})).json();s.success?ae(s.data.ddl||""):t(s.error||"Failed to generate DDL")}catch{t("Failed to generate DDL")}finally{n(!1)}},S=async()=>{n(!0);try{const s=await(await fetch(`${x}/schema/versions`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")||""}`}})).json();s.success&&se(s.data||[])}catch(a){console.error("Failed to fetch schema versions:",a)}finally{n(!1)}},xe=async()=>{if(!w.trim()){t("Please enter a version name");return}n(!0),t(null);try{const s=await(await fetch(`${x}/schema/versions`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:JSON.stringify({version:w,description:V})})).json();s.success?(L(""),F(""),await S()):t(s.error||"Failed to create version")}catch{t("Failed to create schema version")}finally{n(!1)}},P=a=>{navigator.clipboard.writeText(a)},he=()=>{switch(R){case"diagram":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Format:"}),e.jsxs("select",{value:b,onChange:a=>K(a.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"mermaid",children:"Mermaid"}),e.jsx("option",{value:"dot",children:"GraphViz DOT"})]})]}),e.jsxs("button",{onClick:ie,disabled:o,className:"btn btn-primary",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Generate ER Diagram"]}),e.jsxs("button",{onClick:ce,disabled:o,className:"btn btn-secondary",children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Refresh Relationships"]})]}),p&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Generated ",b==="mermaid"?"Mermaid":"DOT"," Code"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>P(p),className:"btn btn-secondary btn-sm",children:[e.jsx(U,{className:"w-4 h-4 mr-1"})," Copy"]}),e.jsxs("button",{onClick:()=>{const a=new Blob([p],{type:"text/plain"}),s=URL.createObjectURL(a),i=document.createElement("a");i.href=s,i.download=`er-diagram.${b==="mermaid"?"mmd":"dot"}`,i.click()},className:"btn btn-secondary btn-sm",children:[e.jsx(q,{className:"w-4 h-4 mr-1"})," Download"]})]})]}),e.jsx("pre",{className:"text-sm font-mono text-gray-700 dark:text-gray-300 overflow-auto max-h-96 whitespace-pre-wrap",children:p})]}),v.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h3",{className:"font-medium text-gray-900 dark:text-white",children:["Relationships (",v.length,")"]})}),e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700 max-h-96 overflow-auto",children:v.map((a,s)=>e.jsxs("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"font-medium text-primary-600",children:a.source_table}),e.jsxs("span",{className:"text-gray-500",children:[".",a.source_column]}),e.jsx(Ne,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"font-medium text-green-600",children:a.target_table}),e.jsxs("span",{className:"text-gray-500",children:[".",a.target_column]})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[a.constraint_name," | ON DELETE ",a.on_delete," | ON UPDATE ",a.on_update]})]},s))})]})]});case"compare":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-end gap-4 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Schema 1"}),e.jsx("select",{value:g,onChange:a=>Q(a.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:B.map(a=>e.jsx("option",{value:a,children:a},a))})]}),e.jsx("div",{className:"text-gray-400",children:e.jsx(O,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Schema 2"}),e.jsxs("select",{value:y,onChange:a=>X(a.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"",children:"Select schema..."}),B.filter(a=>a!==g).map(a=>e.jsx("option",{value:a,children:a},a))]})]}),e.jsxs("button",{onClick:oe,disabled:o||!y,className:"btn btn-primary",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Compare Schemas"]})]}),c&&e.jsxs("div",{className:"space-y-4",children:[c.only_in_first.length>0&&e.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-medium text-yellow-800 dark:text-yellow-200 mb-2",children:["Only in ",g," (",c.only_in_first.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:c.only_in_first.map(a=>e.jsx("span",{className:"px-2 py-1 bg-yellow-100 dark:bg-yellow-900/40 text-yellow-800 dark:text-yellow-200 rounded text-sm",children:a},a))})]}),c.only_in_second.length>0&&e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-medium text-blue-800 dark:text-blue-200 mb-2",children:["Only in ",y," (",c.only_in_second.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:c.only_in_second.map(a=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 dark:bg-blue-900/40 text-blue-800 dark:text-blue-200 rounded text-sm",children:a},a))})]}),c.tables_with_differences.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h4",{className:"font-medium text-gray-900 dark:text-white",children:["Tables with Differences (",c.tables_with_differences.length,")"]})}),e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:c.tables_with_differences.map((a,s)=>e.jsxs("div",{className:"p-4",children:[e.jsx("h5",{className:"font-medium text-gray-900 dark:text-white mb-2",children:a.table_name}),a.column_differences.length>0&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 dark:text-gray-400",children:"Columns:"}),e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-600 dark:text-gray-300",children:a.column_differences.map((i,C)=>e.jsx("li",{children:i},C))})]}),a.index_differences.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 dark:text-gray-400",children:"Indexes:"}),e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-600 dark:text-gray-300",children:a.index_differences.map((i,C)=>e.jsx("li",{children:i},C))})]})]},s))})]}),c.only_in_first.length===0&&c.only_in_second.length===0&&c.tables_with_differences.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[e.jsx(je,{className:"w-12 h-12 mx-auto mb-4 text-green-500"}),e.jsx("p",{className:"font-medium",children:"Schemas are identical!"})]})]})]});case"search":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",value:u,onChange:a=>Y(a.target.value),onKeyDown:a=>a.key==="Enter"&&z(),placeholder:"Search tables, columns, indexes, functions...",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})}),e.jsxs("button",{onClick:z,disabled:o||!u.trim(),className:"btn btn-primary",children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Search"]})]}),l&&e.jsxs("div",{className:"space-y-4",children:[l.tables.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4",children:[e.jsxs("h4",{className:"font-medium text-gray-900 dark:text-white mb-2",children:[e.jsx(fe,{className:"w-4 h-4 inline mr-2"}),"Tables (",l.tables.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:l.tables.map((a,s)=>e.jsxs("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-700 rounded text-sm",children:[a.schema,".",a.name]},s))})]}),l.columns.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4",children:[e.jsxs("h4",{className:"font-medium text-gray-900 dark:text-white mb-2",children:["Columns (",l.columns.length,")"]}),e.jsxs("div",{className:"space-y-1",children:[l.columns.slice(0,20).map((a,s)=>e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-primary-600",children:a.table_name}),e.jsxs("span",{className:"text-gray-500",children:[".",a.column_name]}),e.jsxs("span",{className:"text-gray-400 ml-2",children:["(",a.data_type,")"]})]},s)),l.columns.length>20&&e.jsxs("p",{className:"text-sm text-gray-500",children:["...and ",l.columns.length-20," more"]})]})]}),l.indexes.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4",children:[e.jsxs("h4",{className:"font-medium text-gray-900 dark:text-white mb-2",children:["Indexes (",l.indexes.length,")"]}),e.jsx("div",{className:"space-y-1",children:l.indexes.map((a,s)=>e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:a.name}),e.jsxs("span",{className:"text-gray-500 ml-2",children:["on ",a.table_name]})]},s))})]}),l.functions.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4",children:[e.jsxs("h4",{className:"font-medium text-gray-900 dark:text-white mb-2",children:["Functions (",l.functions.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:l.functions.map((a,s)=>e.jsxs("span",{className:"px-2 py-1 bg-purple-100 dark:bg-purple-900/40 text-purple-800 dark:text-purple-200 rounded text-sm",children:[a.schema,".",a.name,"()"]},s))})]})]})]});case"ddl":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-end gap-4 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Object Type"}),e.jsxs("select",{value:j,onChange:a=>ee(a.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"table",children:"Table"}),e.jsx("option",{value:"index",children:"Index"}),e.jsx("option",{value:"constraint",children:"Constraint"}),e.jsx("option",{value:"view",children:"View"})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Object Name"}),j==="table"?e.jsxs("select",{value:h,onChange:a=>A(a.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"",children:"Select table..."}),te.map(a=>e.jsx("option",{value:a,children:a},a))]}):e.jsx("input",{type:"text",value:h,onChange:a=>A(a.target.value),placeholder:"Enter object name...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]})]}),j==="table"&&e.jsxs("div",{className:"flex gap-4 flex-wrap",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:m.include_indexes,onChange:a=>N({...m,include_indexes:a.target.checked}),className:"rounded"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Include Indexes"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:m.include_constraints,onChange:a=>N({...m,include_constraints:a.target.checked}),className:"rounded"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Include Constraints"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:m.include_triggers,onChange:a=>N({...m,include_triggers:a.target.checked}),className:"rounded"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Include Triggers"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:m.if_not_exists,onChange:a=>N({...m,if_not_exists:a.target.checked}),className:"rounded"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"IF NOT EXISTS"})]})]}),e.jsxs("button",{onClick:me,disabled:o||!h,className:"btn btn-primary",children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"Generate DDL"]}),f&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Generated DDL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>P(f),className:"btn btn-secondary btn-sm",children:[e.jsx(U,{className:"w-4 h-4 mr-1"})," Copy"]}),e.jsxs("button",{onClick:()=>{const a=new Blob([f],{type:"text/sql"}),s=URL.createObjectURL(a),i=document.createElement("a");i.href=s,i.download=`${h}.sql`,i.click()},className:"btn btn-secondary btn-sm",children:[e.jsx(q,{className:"w-4 h-4 mr-1"})," Download"]})]})]}),e.jsx("pre",{className:"text-sm font-mono text-gray-700 dark:text-gray-300 overflow-auto max-h-96 whitespace-pre-wrap",children:f})]})]});case"versions":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-end gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Version Name"}),e.jsx("input",{type:"text",value:w,onChange:a=>L(a.target.value),placeholder:"e.g., v1.0.0",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:V,onChange:a=>F(a.target.value),placeholder:"Optional description...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),e.jsxs("button",{onClick:xe,disabled:o||!w.trim(),className:"btn btn-primary",children:[e.jsx(pe,{className:"w-4 h-4 mr-2"}),"Create Snapshot"]}),e.jsxs("button",{onClick:S,disabled:o,className:"btn btn-secondary",children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Refresh"]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h3",{className:"font-medium text-gray-900 dark:text-white",children:[e.jsx(D,{className:"w-4 h-4 inline mr-2"}),"Schema Versions (",k.length,")"]})}),k.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400",children:[e.jsx(D,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No schema versions yet"}),e.jsx("p",{className:"text-sm",children:"Create a snapshot to track schema changes"})]}):e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700 max-h-96 overflow-auto",children:k.map(a=>e.jsx("div",{className:"p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:a.version}),a.description&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:a.description}),e.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:["Created: ",new Date(a.created_at).toLocaleString(),a.created_by&&` by ${a.created_by}`]})]}),e.jsxs("button",{onClick:()=>_(a),className:"btn btn-secondary btn-sm",children:[e.jsx(ue,{className:"w-4 h-4 mr-1"})," View"]})]})},a.id))})]})]})}};return e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Schema Tools"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Explore and manage your database schema"})]}),E&&e.jsxs("div",{className:"mb-4 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg flex items-center gap-3",children:[e.jsx(ye,{className:"w-5 h-5 text-red-500"}),e.jsx("span",{className:"text-red-700 dark:text-red-300",children:E}),e.jsx("button",{onClick:()=>t(null),className:"ml-auto text-red-500 hover:text-red-700",children:"×"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsx("nav",{className:"flex -mb-px",children:[{id:"diagram",label:"ER Diagram",icon:M},{id:"compare",label:"Compare",icon:O},{id:"search",label:"Search",icon:G},{id:"ddl",label:"DDL Generator",icon:J},{id:"versions",label:"Versions",icon:D}].map(a=>e.jsxs("button",{onClick:()=>{H(a.id),a.id==="versions"&&k.length===0&&S()},className:be("flex items-center gap-2 px-4 py-3 text-sm font-medium border-b-2 -mb-px transition-colors",R===a.id?"border-primary-500 text-primary-600 dark:text-primary-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:[e.jsx(a.icon,{className:"w-4 h-4"}),a.label]},a.id))})}),e.jsxs("div",{className:"p-6",children:[o&&e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(T,{className:"w-6 h-6 animate-spin text-primary-500"}),e.jsx("span",{className:"ml-2 text-gray-500",children:"Loading..."})]}),!o&&he()]})]}),d&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-3xl w-full mx-4 max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Schema Version: ",d.version]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:d.description||"No description"})]}),e.jsx("button",{onClick:()=>_(null),className:"text-gray-400 hover:text-gray-500",children:"×"})]}),e.jsx("div",{className:"p-6 overflow-y-auto flex-1",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Details"}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Version ID:"}),e.jsx("span",{className:"font-mono text-gray-900 dark:text-white",children:d.id})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Created:"}),e.jsx("span",{className:"text-gray-900 dark:text-white",children:new Date(d.created_at).toLocaleString()})]}),d.created_by&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Created by:"}),e.jsx("span",{className:"text-gray-900 dark:text-white",children:d.created_by})]})]})]}),d.changes&&Array.isArray(d.changes)&&d.changes.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Changes"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:e.jsx("pre",{className:"text-sm font-mono text-gray-700 dark:text-gray-300 whitespace-pre-wrap",children:JSON.stringify(d.changes,null,2)})})]}),d.schema_snapshot!==null&&d.schema_snapshot!==void 0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Schema Snapshot"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 max-h-64 overflow-auto",children:e.jsx("pre",{className:"text-xs font-mono text-gray-700 dark:text-gray-300 whitespace-pre-wrap",children:JSON.stringify(d.schema_snapshot,null,2)})})]})]})}),e.jsx("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex justify-end",children:e.jsx("button",{onClick:()=>_(null),className:"btn btn-secondary",children:"Close"})})]})})]})}export{Oe as default};
