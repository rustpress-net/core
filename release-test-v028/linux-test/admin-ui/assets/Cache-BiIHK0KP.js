import{r,F as _,I as S,a2 as R,u as U,Q as z,j as e,ac as x,a1 as W,t as F,q as l,n as M,k as I,T as $,l as T}from"./index-rtSsgAPH.js";import{z as n}from"./index-QhLp66VR.js";import{a as o}from"./client-TYy9hZMt.js";import{R as q}from"./refresh-cw-BVqTSYJG.js";import{A as K}from"./activity-B-kkqPX8.js";import{H as Q}from"./hard-drive-B-hSgZsf.js";import{C as Z}from"./cpu-QRQCGOO0.js";import{S as J}from"./server-FXDtJVKT.js";const O=[{name:"Pages",key_pattern:"page:*",description:"Rendered page cache",count:0,icon:_},{name:"Posts",key_pattern:"post:*",description:"Post content cache",count:0,icon:_},{name:"Media",key_pattern:"media:*",description:"Media metadata cache",count:0,icon:S},{name:"Thumbnails",key_pattern:"thumb:*",description:"Image thumbnail cache",count:0,icon:S},{name:"Queries",key_pattern:"query:*",description:"Database query cache",count:0,icon:R},{name:"Sessions",key_pattern:"session:*",description:"User session cache",count:0,icon:U},{name:"API",key_pattern:"api:*",description:"API response cache",count:0,icon:z}],V=t=>{if(t===0)return"0 B";const m=1024,s=["B","KB","MB","GB"],i=Math.floor(Math.log(t)/Math.log(m));return parseFloat((t/Math.pow(m,i)).toFixed(2))+" "+s[i]},p=t=>t>=1e6?(t/1e6).toFixed(1)+"M":t>=1e3?(t/1e3).toFixed(1)+"K":t.toString();function ce(){const[t,m]=r.useState({hits:0,misses:0,entries:0,memory_bytes:0,evictions:0,hit_rate:0}),[s,i]=r.useState({enabled:!0,default_ttl:3600,max_entries:1e4,backend:"memory"}),[B,A]=r.useState(O),[E,y]=r.useState(!0),[b,u]=r.useState(!1),[j,f]=r.useState(null),[N,k]=r.useState(!1),[v,w]=r.useState(!1),[h,C]=r.useState("dashboard"),d=r.useCallback(async()=>{try{y(!0);const[a,g]=await Promise.all([o.get("/cache/stats"),o.get("/cache/config")]);if(a.data){const c=a.data;m({...c,hit_rate:c.hits+c.misses>0?c.hits/(c.hits+c.misses)*100:0})}g.data&&i(g.data),A(c=>c.map(H=>({...H,count:Math.floor(Math.random()*500)})))}catch(a){console.error("Failed to load cache stats:",a)}finally{y(!1)}},[]);r.useEffect(()=>{d();const a=setInterval(d,3e4);return()=>clearInterval(a)},[d]);const D=async()=>{u(!0);try{await o.post("/cache/clear"),n.success("Cache cleared successfully"),d()}catch(a){console.error("Failed to clear cache:",a),n.error("Failed to clear cache")}finally{u(!1)}},G=async(a,g)=>{f(a);try{await o.post("/cache/clear",{pattern:a}),n.success(`${g} cache cleared`),d()}catch(c){console.error("Failed to clear cache group:",c),n.error("Failed to clear cache")}finally{f(null)}},L=async()=>{k(!0);try{await o.post("/cache/warm-up"),n.success("Cache warm-up started"),setTimeout(d,5e3)}catch(a){console.error("Failed to warm up cache:",a),n.error("Failed to start warm-up")}finally{k(!1)}},P=async()=>{w(!0);try{await o.put("/cache/config",s),n.success("Cache configuration saved")}catch(a){console.error("Failed to save config:",a),n.error("Failed to save configuration")}finally{w(!1)}};return E?e.jsx("div",{className:"flex items-center justify-center min-h-96",children:e.jsx(x,{className:"w-8 h-8 animate-spin text-primary-500"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Cache Management"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Monitor and manage your site's cache"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:d,className:"btn btn-secondary",children:[e.jsx(q,{className:"w-4 h-4"}),"Refresh"]}),e.jsxs("button",{onClick:L,disabled:N,className:"btn btn-secondary",children:[N?e.jsx(x,{className:"w-4 h-4 animate-spin"}):e.jsx(W,{className:"w-4 h-4"}),"Warm Up"]}),e.jsxs("button",{onClick:D,disabled:b,className:"btn bg-red-600 text-white hover:bg-red-700",children:[b?e.jsx(x,{className:"w-4 h-4 animate-spin"}):e.jsx(F,{className:"w-4 h-4"}),"Clear All"]})]})]}),e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsxs("nav",{className:"flex gap-4",children:[e.jsxs("button",{onClick:()=>C("dashboard"),className:l("flex items-center gap-2 px-4 py-3 text-sm font-medium border-b-2 transition-colors",h==="dashboard"?"border-primary-500 text-primary-600 dark:text-primary-400":"border-transparent text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"),children:[e.jsx(K,{className:"w-4 h-4"}),"Dashboard"]}),e.jsxs("button",{onClick:()=>C("config"),className:l("flex items-center gap-2 px-4 py-3 text-sm font-medium border-b-2 transition-colors",h==="config"?"border-primary-500 text-primary-600 dark:text-primary-400":"border-transparent text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"),children:[e.jsx(M,{className:"w-4 h-4"}),"Configuration"]})]})}),h==="dashboard"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/30 rounded-lg",children:e.jsx(I,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Hit Rate"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[t.hit_rate.toFixed(1),"%"]})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:e.jsx($,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Hits"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:p(t.hits)})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-orange-100 dark:bg-orange-900/30 rounded-lg",children:e.jsx(T,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Misses"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:p(t.misses)})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/30 rounded-lg",children:e.jsx(R,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Entries"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:p(t.entries)})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gray-100 dark:bg-gray-800 rounded-lg",children:e.jsx(Q,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Memory"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:V(t.memory_bytes)})]})]})})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Cache Performance"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Hit Rate"}),e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:[t.hit_rate.toFixed(1),"%"]})]}),e.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:l("h-full rounded-full transition-all duration-500",t.hit_rate>=80?"bg-green-500":t.hit_rate>=50?"bg-yellow-500":"bg-red-500"),style:{width:`${t.hit_rate}%`}})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Evictions"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:p(t.evictions)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Backend"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white capitalize",children:s.backend})]})]})]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Cache Groups"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:B.map(a=>e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white dark:bg-gray-700 rounded-lg",children:e.jsx(a.icon,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:a.name}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:a.description})]})]})}),e.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[a.count," entries"]}),e.jsxs("button",{onClick:()=>G(a.key_pattern,a.name),disabled:j===a.key_pattern,className:"text-sm text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 flex items-center gap-1",children:[j===a.key_pattern?e.jsx(x,{className:"w-3 h-3 animate-spin"}):e.jsx(F,{className:"w-3 h-3"}),"Clear"]})]})]},a.key_pattern))})]})]}),h==="config"&&e.jsxs("div",{className:"card p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Cache Configuration"}),e.jsxs("button",{onClick:P,disabled:v,className:"btn btn-primary",children:[v?e.jsx(x,{className:"w-4 h-4 animate-spin"}):e.jsx(M,{className:"w-4 h-4"}),"Save Config"]})]}),e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"Enable Caching"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Turn caching on or off globally"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.enabled,onChange:a=>i({...s,enabled:a.target.checked}),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 dark:peer-focus:ring-primary-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-primary-600"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Cache Backend"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("button",{onClick:()=>i({...s,backend:"memory"}),className:l("p-4 rounded-lg border-2 text-left transition-colors",s.backend==="memory"?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-gray-200 dark:border-gray-700"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Z,{className:"w-6 h-6 text-gray-600 dark:text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Memory"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Fast, in-process cache"})]})]})}),e.jsx("button",{onClick:()=>i({...s,backend:"redis"}),className:l("p-4 rounded-lg border-2 text-left transition-colors",s.backend==="redis"?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-gray-200 dark:border-gray-700"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(J,{className:"w-6 h-6 text-gray-600 dark:text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Redis"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Distributed cache"})]})]})})]})]}),s.backend==="redis"&&e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Redis URL"}),e.jsx("input",{type:"text",className:"input",value:s.redis_url||"",onChange:a=>i({...s,redis_url:a.target.value}),placeholder:"redis://localhost:6379"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Default TTL (seconds)"}),e.jsx("input",{type:"number",className:"input",value:s.default_ttl,onChange:a=>i({...s,default_ttl:parseInt(a.target.value)||3600}),min:60,max:86400}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"How long items stay in cache (60-86400 seconds)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Max Entries"}),e.jsx("input",{type:"number",className:"input",value:s.max_entries,onChange:a=>i({...s,max_entries:parseInt(a.target.value)||1e4}),min:100,max:1e6}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Maximum number of items in cache"})]}),e.jsx("div",{className:l("p-4 rounded-lg border",s.enabled?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":"bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[s.enabled?e.jsx(I,{className:"w-5 h-5 text-green-600 dark:text-green-400"}):e.jsx(T,{className:"w-5 h-5 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:l("font-medium",s.enabled?"text-green-800 dark:text-green-200":"text-gray-700 dark:text-gray-300"),children:s.enabled?"Cache is Active":"Cache is Disabled"}),e.jsx("p",{className:l("text-sm",s.enabled?"text-green-600 dark:text-green-400":"text-gray-500"),children:s.enabled?`Using ${s.backend} backend with ${s.default_ttl}s TTL`:"Enable caching to improve performance"})]})]})})]})]})]})}export{ce as default};
